<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<title>Global Stories</title>
	<link rel="stylesheet" type="text/css" href="style.css" />
	<link rel="stylesheet" href="leaflet/leaflet.css" />
	<script src="leaflet/leaflet.js"></script>
    <script type="text/javascript" src="functions.js"></script>
    <script type="text/javascript" src="controls.js"></script>
    <script type="text/javascript" src="http://maps.stamen.com/js/tile.stamen.js?v1.2.4"></script>
    <script type="text/javascript" src="countries.js"></script>
    <script type="text/javascript" src="oceans.js"></script>
    <script type="text/javascript" scr="country-flags.js"></script>
    <script type="text/javascript" src="Leaflet.EasyButton/easy-button.js"></script>
    <script src="oms.min.js"></script>
    <script type="text/javascript" src="names.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script>
    <script type="text/javascript" src="Leaflet-MiniMap/src/Control.MiniMap.js"></script>
    <script type="text/javascript" src="leaflet-zoom-min/L.Control.ZoomMin.js"></script>
</head>
<body>
    <nav>
    <div id="layerToggle">
        <form name="switches">
            <img src="leaflet/images/logo.png" alt="Global Stories Logo">
            <label class="toggle" id="see_all1">SEE ALL STORIES
                <input class="checkbox" type="checkbox" name="see_all1" onclick="toggle('switches')">
            </label>
            <div class="divider"></div>
            <label class="toggle" id="selectLabel">SELECT STORIES ABOUT</label>
            <label class="toggle" id="aidLabel">AID
                <input class="checkbox" type="checkbox" name="aid" onclick="removeAid()">
            </label>
            <label class = "toggle" id="econ">DEVELOPMENT
                <input class="checkbox" type="checkbox" name="economic" onclick="removeEcon()">
            </label>
            <label class="toggle" id="enviro">ENVIRONMENT
                <input class="checkbox" type="checkbox" name="environment" onclick="removeEnviro()">
            </label>
            <label class="toggle" id="human_rights">HUMAN RIGHTS
                <input class="checkbox" type="checkbox" name="hr" onclick="removeHR()">
            </label>
            <label class = "toggle" id="polit">POLITICS & SOCIETY
                <input class="checkbox" type="checkbox" name="political" onclick="removePolit()">
            </label>
            <label class="toggle" id="seeAll">SEE ALL STORIES
                <input class="checkbox" type="checkbox" name="see_all2" onclick="toggle('switches');">
            </label>
        </form>
    </div>
    </nav>
    <div id="map"></div>
    <div id="side_bar"></div>
    <!--<div id="top_stories"></div>-->
    <script>

        //The images used for the markers
        var redCircle = L.icon({
            iconUrl: 'leaflet/images/red_circle.png'
        });

        var greenCircle = L.icon({
            iconUrl: 'leaflet/images/green_circle.png'
        });

        var blueCircle = L.icon({
            iconUrl: 'leaflet/images/blue_circle.png'
        });

        var yellowCircle = L.icon({
            iconUrl: 'leaflet/images/yellow_circle.png'
        });

        var purpleCircle = L.icon({
            iconUrl: 'leaflet/images/purple_circle.png'
        });

        //Creating variables for the markers in the map. These are added manually to give an example of how the buttons that select certain types of markers (aid, development, etc. work)
    	var M1 = L.marker([10.055, 37.792], {icon: purpleCircle}).bindPopup("Marker 1"),
    		M2 = L.marker([39.232, 31.289], {icon: purpleCircle}).bindPopup("Marker 2"),
    		M3 = L.marker([13.752, -89.121], {icon: purpleCircle}).bindPopup("Marker 3"),
    		M4 = L.marker([-24.206, -58.535], {icon: blueCircle}).bindPopup("Marker 4"),
    		M5 = L.marker([47.040, 99.140], {icon: blueCircle}).bindPopup("Marker 5");
            M6 = L.marker([10.123, 20.123], {icon: redCircle}).bindPopup("Marker 6");
            M7 = L.marker([0, 0], {icon: greenCircle}).bindPopup("Marker 7");
            M8 = L.marker([13.752, -89.121], {icon: purpleCircle}).bindPopup("Marker 8"),
            M9 = L.marker([13.752, -89.121], {icon: purpleCircle}).bindPopup("Marker 9"),
            M10 = L.marker([10.123, 20.123], {icon: greenCircle}).bindPopup("Marker 10");
            M11 = L.marker([10.123, 20.123], {icon: yellowCircle}).bindPopup("Marker 11");
            M12 = L.marker([10.123, 20.123], {icon: yellowCircle}).bindPopup("Marker 12");
            M13 = L.marker([10.123, 20.123], {icon: yellowCircle}).bindPopup("Marker 13");
            M14 = L.marker([10.123, 20.123], {icon: yellowCircle}).bindPopup("Marker 14");
            M15 = L.marker([10.123, 20.123], {icon: yellowCircle}).bindPopup("Marker 15");
            M16 = L.marker([10.123, 20.123], {icon: yellowCircle}).bindPopup("Marker 16");
            M17 = L.marker([10.123, 20.123], {icon: yellowCircle}).bindPopup("Marker 17");
            M18 = L.marker([10.123, 20.123], {icon: yellowCircle}).bindPopup("Marker 18");
            M19 = L.marker([10.123, 20.123], {icon: yellowCircle}).bindPopup("Marker 19");


        var markers = [M1, M2, M3, M4, M5, M6, M7, M8, M9, M10, M11, M12, M13, M14, M15, M16, M17, M18, M19]

        var political = L.layerGroup([M1, M2, M3]),
            economic = L.layerGroup([M4, M5]);
            aid = L.layerGroup([M6]);
            environment = L.layerGroup([M7, M8, M9, M10]);
            hr = L.layerGroup([M11, M12, M13, M14, M15, M16, M17, M18, M19]);
        
        var southWest = L.latLng(40.712, -74.227),
    		northEast = L.latLng(40.774, -74.125),
    		bounds = L.latLngBounds(southWest, northEast);

        //Styling for country layer
    	var countryStyle = {
    		'color': '#001A33',
    		'weight': 1.2,
    		'opacity': 1,
    		'fillColor': '#000',
    		'fillOpacity': 1
		};

        var oceanStyle = {
            'color': '#001429',
            'weight': 3,
            'opacity': 0.6,
            'fillColor': '#001429',
            'fillOpacity': 1
        };

        //Creates the country data layer
		var geojson;

        //Creates the map variable and initial view
		var map = L.map('map', {zoomControl: false});

        var zoomLevel = 1;

        L.tileLayer('http://{s}.tiles.mapbox.com/v3/MapID/997/256/{z}/{x}/{y}.png', {
            maxZoom: 18,
        }).addTo(map);

        map.locate({setView: true, maxZoom: zoomLevel});

        map.on('locationfound', onLocationFound);
        map.on('locationerror', onLocationError);

        //Base map layer
		var Stamen_Toner = L.tileLayer('http://{s}.tile.stamen.com/toner-background/{z}/{x}/{y}.png', {
                subdomains: 'abcd',
                subdomains: 'abcd',
                minZoom: 0,
                maxZoom: 20,
                noWrap: true
		  }).addTo(map)

		//Adds interactive features to the country layer
        geojson = L.geoJson(countries, {
    		style: countryStyle,
    		onEachFeature: onEachFeature
		}).addTo(map);

        oceans = L.geoJson(oceans, {
            style: oceanStyle,
            onEachFeature: onOcean
        }).addTo(map);

        //Adds markers to the map
        map.addLayer(economic);
        map.addLayer(political);
        map.addLayer(aid);
        map.addLayer(environment);
        map.addLayer(hr);
        attachHover(markers);

        var oms = new OverlappingMarkerSpiderfier(map);
        addOverlap(markers);

        //Adds controls to the map
		info.addTo(map);
        //zoomOut.addTo(map);
        L.easyButton('fa-compass', function() {map.setView([-3.578, 3.515], zoomLevel)}, 'Zoom Out!');

        //map.addControl(new L.Control.ZoomMin());

        //disables dragging and zooming
		map.dragging.disable();
        map.touchZoom.disable();
        map.doubleClickZoom.disable();
        map.scrollWheelZoom.disable();

        //Plugin magic goes here! Note that you cannot use the same layer object again, as that will confuse the two map controls
        var osmUrl='http://{s}.tile.stamen.com/toner-background/{z}/{x}/{y}.png';
        var osm = new L.TileLayer(osmUrl, {minZoom: 1, maxZoom: 18});


        map.setView(new L.LatLng(-3.578, 3.515), 1);
        
        //Plugin magic goes here! Note that you cannot use the same layer object again, as that will confuse the two map controls
        var osm2 = new L.TileLayer(osmUrl, {minZoom: 0, maxZoom: 13, noWrap: true});
        var miniMap = new L.Control.MiniMap(osm2, { toggleDisplay: false, position: 'bottomleft', width: 200, height: 200, aimingRectOptions: {color: '#001429', fillColor: '#001429', fillOpacity: .5}}).addTo(map);

    </script>
</body>
</html>
